<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Memory-Spiel</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f0f0f0;
      margin: 0;
    }

    #difficultySelection {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      z-index: 999;
    }

    #gameBoard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      grid-gap: 10px;
      justify-content: center;
      width: 90vw;
      max-width: 600px;
      margin: 100px auto 20px;
    }

    .card {
      aspect-ratio: 1 / 1;
      font-size: 2rem;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: white;
      border-radius: 10px;
      cursor: pointer;
      user-select: none;
      border: 2px solid #ccc;
    }

    .matched {
      background-color: lightgreen !important;
    }

    .hidden {
      visibility: hidden;
    }

    .button {
      margin: 5px;
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      background-color: #007bff;
      color: white;
      cursor: pointer;
      font-size: 1rem;
    }

    .button:hover {
      background-color: #23d482;
    }
  </style>
</head>
<body>

<div id="difficultySelection">
  <h2>WÃ¤hle den Schwierigkeitsgrad</h2>
  <button class="button" onclick="startGame('easy')">Leicht</button>
  <button class="button" onclick="startGame('medium')">Mittel</button>
  <button class="button" onclick="startGame('hard')">Schwer</button>
</div>

<div id="gameBoard"></div>
<div id ="ZurÃ¼ck"> </div>
<button class="button" onclick=""window.location.href='index.html'">ðŸ”™ ZurÃ¼ck</button>
<script>
  const gameBoard = document.getElementById("gameBoard");
  let firstCard, secondCard, lockBoard = false;
  let currentPlayer = "player";
  let botDifficulty = "easy";
  let emojis = [];
  let matchedPairs = 0;

  const emojiPacks = {
    default: ["ðŸŽ","ðŸŒ","ðŸ‡","ðŸ“","ðŸ","ðŸ¥","ðŸ‰","ðŸ’"],
    tiere: ["ðŸ¶","ðŸ±","ðŸ­","ðŸ¦Š","ðŸ»","ðŸ¼","ðŸ¨","ðŸ¯"],
    meme: ["ðŸ˜‚","ðŸ˜Ž","ðŸ¥¶","ðŸ¤“","ðŸ˜¡","ðŸ˜±","ðŸ¥µ","ðŸ˜´"]
  };

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function loadSettings() {
    const pack = localStorage.getItem('emojiPack') || 'default';
    const back = localStorage.getItem('cardBack') || 'â”';
    const bg = localStorage.getItem('background') || '#f0f0f0';
    document.body.style.backgroundColor = bg;
    emojis = emojiPacks[pack] || emojiPacks['default'];
    cardBackSymbol = back;
  }

  function startGame(difficulty) {
    botDifficulty = difficulty;
    document.getElementById("difficultySelection").style.display = "none";
    loadSettings();
    initBoard();
  }

function initBoard() {
  const cards = [...emojis, ...emojis];
  shuffle(cards);
  gameBoard.innerHTML = "";
  matchedPairs = 0;

  const totalCards = cards.length;
  const columns = Math.ceil(Math.sqrt(totalCards)); // z.B. 4 fÃ¼r 16 Karten

  gameBoard.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;

  cards.forEach(emoji => {
    const card = document.createElement("div");
    card.className = "card";
    card.dataset.emoji = emoji;
    card.textContent = cardBackSymbol;
    card.addEventListener("click", handleCardClick);
    gameBoard.appendChild(card);
  });
}


  function handleCardClick() {
    if (lockBoard || this.classList.contains("matched") || this === firstCard || currentPlayer !== "player") return;

    this.textContent = this.dataset.emoji;

    if (!firstCard) {
      firstCard = this;
      return;
    }

    secondCard = this;
    lockBoard = true;

    if (firstCard.dataset.emoji === secondCard.dataset.emoji) {
      firstCard.classList.add("matched");
      secondCard.classList.add("matched");
      matchedPairs++;
      resetTurn();
      if (matchedPairs === emojis.length) {
        alert("Du hast gewonnen!");
      }
    } else {
      setTimeout(() => {
        firstCard.textContent = cardBackSymbol;
        secondCard.textContent = cardBackSymbol;
        resetTurn();
        currentPlayer = "bot";
        botTurn();
      }, 800);
    }
  }

  function resetTurn() {
    [firstCard, secondCard] = [null, null];
    lockBoard = false;
  }

  function botTurn() {
    const cards = Array.from(document.querySelectorAll(".card")).filter(
      c => !c.classList.contains("matched") && c.textContent === cardBackSymbol
    );

    if (cards.length < 2) return;

    let first, second;

    if (botDifficulty === "easy") {
      first = cards[Math.floor(Math.random() * cards.length)];
      do {
        second = cards[Math.floor(Math.random() * cards.length)];
      } while (second === first);
    }

    first.textContent = first.dataset.emoji;
    second.textContent = second.dataset.emoji;

    setTimeout(() => {
      if (first.dataset.emoji === second.dataset.emoji) {
        first.classList.add("matched");
        second.classList.add("matched");
        matchedPairs++;
        if (matchedPairs === emojis.length) {
          alert("Bot hat gewonnen!");
        } else {
          botTurn(); // Bot darf nochmal ran
        }
      } else {
        first.textContent = cardBackSymbol;
        second.textContent = cardBackSymbol;
        currentPlayer = "player";
      }
    }, 800);
  }
</script>

</body>
</html>

