<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>üéØ Memory Special Modes</title>
  <style>
    body {
      font-family: sans-serif;
      background: var(--background, linear-gradient(to right, #ff9a9e, #fad0c4));
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      color: #fff;
      transition: background 1s;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
    }

    .button {
      padding: 12px 25px;
      margin: 10px;
      background: linear-gradient(90deg, #6a11cb, #2575fc);
      border: none;
      border-radius: 10px;
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: transform 0.2s, background 0.5s;
    }
    .button:hover {
      transform: scale(1.05);
      background: linear-gradient(90deg, #43cea2, #185a9d);
    }

    #startScreen, #gameArea {
      display: none;
      flex-direction: column;
      align-items: center;
    }

    .grid {
      display: grid;
      gap: 10px;
      margin-top: 20px;
      justify-content: center;
    }

    .card {
      font-size: clamp(20px, 4vw, 36px);
      width: clamp(50px, 8vw, 80px);
      height: clamp(50px, 8vw, 80px);
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      cursor: pointer;
      user-select: none;
      border: 2px solid #888;
      transition: background 0.3s, transform 0.2s;
    }

    .card:hover {
      transform: scale(1.05);
    }

    .matched {
      background: lightgreen !important;
      cursor: default;
    }

    #timer {
      font-size: 22px;
      margin-top: 10px;
      color: #ffeb3b;
      text-shadow: 1px 1px 3px #000;
    }

    #gameOver {
      font-size: 24px;
      margin-top: 20px;
      color: #00ff73;
    }
  </style>
</head>
<body>
  <h1>üéØ Memory ‚Äì Spezialmodi</h1>

  <div id="modeSelect">
    <p>W√§hle deinen Spezialmodus:</p>
    <button class="button" onclick="startGame('shuffle')">üîÑ Shuffle-Modus</button>
    <button class="button" onclick="startGame('bomb')">üí£ Bomben-Modus</button>
    <button class="button" onclick="startGame('timestop')">‚è±Ô∏è TimeStop-Modus</button>
    <button class= "button" onclick="window.location.href='index.html'"> üîô Zur√ºck</button> 

  </div>

  <div id="gameArea">
    <div id="timer">‚è±Ô∏è Zeit: 60s</div>
    <div id="gameContainer" class="grid"></div>
    <div id="gameOver" style="display:none;">üéâ Spiel beendet!</div>
  </div>

  <script>
    const backgrounds = {
      "Sunset": "linear-gradient(to right, #ff7e5f, #feb47b)",
      "Ocean": "linear-gradient(to right, #43cea2, #185a9d)",
      "Mint": "linear-gradient(to right, #a1ffce, #faffd1)",
      "Dark": "#222",
      "Blue": "#4d79ff",
      "Peach": "linear-gradient(to right, #ffecd2, #fcb69f)",
      "Red" : "#ff4d4d",
      "Lavender" : "#e0bbff",
      "Sky": "linear-gradient(to right, #00c6ff, #0072ff)",
      "Fire": "linear-gradient(to right, #f12711, #f5af19)",
      "Babyblau": "#a9bff9",
      "neon-gr√ºn": "#27F584",
      "Aquamarin": "#66cdaa",
      "Rainbow1": "linear-gradient(90deg, #FF0000, #FF7F00, #FFFF00, #00FF00, #0000FF, #4B0082, #8B00FF)"
    };

    const cardBacks = {
      "üîµ Blue": "üîµ",
      "üî¥ Red": "üî¥",
      "üü¢ Green": "üü¢",
      "üßä Ice": "üßä",
      "üíé Diamond": "üíé",
      "üíÄ Skull": "üíÄ",
      "üåà Rainbow": "üåà",
      "üî• Flamme" : "üî•",
      "üê∞ Rabbit" : "üê∞",
      "üêº Panda" : "üêº",
      " Lime Heart üíö": "üíö"
    };

    const emojiPacks = {
      "Smileys üòÄ": ["üòÄ","üòÉ","üòÑ","üòÅ","üòÜ","üòÖ","üòÇ","ü§£","üòä","üòá","ü§¢","üòµ‚Äçüí´","üòé","ü§©","üòè","üôÉ","üòâ","üòú","üòù","üòõ","ü§ë"],
      "Animals üê∂": ["üê∂","üê±","üê≠","üêπ","üê∞","ü¶ä","üêª","üêº","üê®","üêØ","ü¶Å","üêÆ"],
      "Tech üíª": ["üíª","üì±","üñ•Ô∏è","üñ®Ô∏è","‚å®Ô∏è","üñ±Ô∏è","üíæ","üß†","ü§ñ","üì°"]
    };

    let timer = 90;
    let timerInterval;
    let mode = "";
    let lock = false;
    let firstCard = null;
    let matches = 0;

    const emojiPackName = localStorage.getItem("emojiPack") || "Smileys üòÄ";
    const gridSize = localStorage.getItem("gridSize") || "4x4";
    const cardBackName = localStorage.getItem("cardBack") || "üîµ Blue";
    const backgroundName = localStorage.getItem("background") || "Mint";
    const symbols = emojiPacks[emojiPackName] || emojiPacks["Smileys üòÄ"];
    document.body.style.setProperty("--background", backgrounds[backgroundName]);

    const [cols, rows] = gridSize.split("x").map(n => parseInt(n));
    const totalCards = cols * rows;
    const pairsNeeded = totalCards / 2;

    function startGame(selectedMode) {
      mode = selectedMode;
      document.getElementById("modeSelect").style.display = "none";
      document.getElementById("gameArea").style.display = "flex";
      initGame();
    }

    function initGame() {
      const container = document.getElementById("gameContainer");
      container.innerHTML = "";
      container.style.gridTemplateColumns = `repeat(${cols}, auto)`;
      let chosen = symbols.slice(0, pairsNeeded);
      const allCards = [...chosen, ...chosen];
      shuffle(allCards);

      // Bombenmodus: Ersetze zuf√§llig Karten mit üí£
      if (mode === "bomb") {
        for (let i = 0; i < 2; i++) {
          const rand = Math.floor(Math.random() * allCards.length);
          allCards[rand] = "üí£";
        }
      }

      allCards.forEach(symbol => {
        const div = document.createElement("div");
        div.className = "card";
        div.dataset.symbol = symbol;
        div.innerText = cardBacks[cardBackName];
        div.addEventListener("click", () => handleClick(div));
        container.appendChild(div);
      });

      startTimer();

      if (mode === "shuffle") {
        setInterval(() => shuffleCards(container), 20000);
      }
    }

    function handleClick(div) {
      if (lock || div.classList.contains("matched") || div.innerText !== cardBacks[cardBackName]) return;
      div.innerText = div.dataset.symbol;

      if (mode === "bomb" && div.dataset.symbol === "üí£") {
     
        updateTimerDisplay();
        div.style.background = "red";
        return;
      }

      if (!firstCard) {
        firstCard = div;
      } else {
        lock = true;
        setTimeout(() => {
          if (firstCard.dataset.symbol === div.dataset.symbol) {
            firstCard.classList.add("matched");
            div.classList.add("matched");
            matches++;
          } else {
            firstCard.innerText = cardBacks[cardBackName];
            div.innerText = cardBacks[cardBackName];
          }
          firstCard = null;
          lock = false;
          if (matches === pairsNeeded) finishGame();
        }, 700);
      }
    }

    function shuffleCards(container) {
      const cards = Array.from(container.children);
      cards.sort(() => Math.random() - 0.5);
      cards.forEach(card => container.appendChild(card));
    }

    function startTimer() {
      updateTimerDisplay();
      timerInterval = setInterval(() => {
        timer--;
        updateTimerDisplay();
        if (timer <= 0) {
          clearInterval(timerInterval);
          finishGame(true);
        }
      }, 1000);
    }

    function updateTimerDisplay() {
      document.getElementById("timer").innerText = `‚è±Ô∏è Zeit: ${timer}s`;
    }

    function finishGame(timeUp = false) {
      clearInterval(timerInterval);
      document.getElementById("gameOver").style.display = "block";
      document.getElementById("gameOver").innerText = timeUp ? "‚è∞ Zeit abgelaufen!" : "üéâ Runde gewonnen!";
    }

    function goBack() {
      window.location.href = "Analyse.html";
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }
  </script>
</body>
</html>
