<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Memory Clash 2</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: var(--background, linear-gradient(to right, #a1ffce, #faffd1));
      transition: background 0.5s;
    }
    .button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 18px;
      cursor: pointer;
      border-radius: 10px;
      border: none;
      background-color: #4CAF50;
      color: white;
    }
    .popup {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .popup-content {
      background: white;
      padding: 20px;
      border-radius: 20px;
      max-height: 90vh;
      overflow-y: auto;
    }
    .item-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 10px;
    }
    .shop-item {
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>üéÆ Memory Clash</h1>
  <div id="coinDisplay">üí∞ Coins: <span id="coins">0</span></div>
  <div id="statDisplay">üìä Spiele gespielt: <span id="gamesPlayed">0</span></div>

  <button class="button" onclick="startGame()">‚ñ∂Ô∏è Spiel starten</button>
  <button class="button" onclick="openShop()">üõí Shop √∂ffnen</button>

  <div id="popup" class="popup" style="display:none">
    <div class="popup-content" id="popupContent"></div>
  </div>

  <script>
    let coins = parseInt(localStorage.getItem("coins")) || 500;
    let gamesPlayed = parseInt(localStorage.getItem("gamesPlayed")) || 0;
    const ownedItems = JSON.parse(localStorage.getItem("ownedItems") || '{}');
    let selectedEmojiPack = localStorage.getItem("emojiPack") || "Smileys üòÄ";
    let selectedBackground = localStorage.getItem("background") || "";
    let selectedCardBack = localStorage.getItem("cardBack") || "üîµ Blue";

    const backgrounds = [
      { name: "Red", value: "#ff4d4d", price: 50 },
      { name: "Blue", value: "#4d79ff", price: 50 },
      { name: "Sunset", value: "üåá Sunset", realValue: "linear-gradient(to right, #ff7e5f, #feb47b)", price: 200 },
      { name: "Ocean", value: "üåä Ocean", realValue: "linear-gradient(to right, #43cea2, #185a9d)", price: 250 },
      { name: "Peach", value: "üçë Peach", realValue: "linear-gradient(to right, #ffecd2, #fcb69f)", price: 200 },
      { name: "Mint", value: "üåø Mint", realValue: "linear-gradient(to right, #a1ffce, #faffd1)", price: 150 },
      { name: "Dark", value: "üñ§ Dark", realValue: "#222", price: 50 },
      { name: "Lavender", value: "üíú Lavender", realValue: "#e0bbff", price: 50 },
      { name: "Fire", value: "üî• Fire", realValue: "linear-gradient(to right, #f12711, #f5af19)", price: 300 },
      { name: "Sky", value: "üå§Ô∏è Sky", realValue: "linear-gradient(to right, #00c6ff, #0072ff)", price: 250 }
    ];

    const emojis = [
      { name: "Smileys üòÄ", value: "üòÄüòÉüòÑüòÅüòÜüòÖüòÇü§£üòäüòá", price: 100 },
      { name: "Animals üê∂", value: "üê∂üê±üê≠üêπüê∞ü¶äüêªüêºüê®üêØ", price: 0},
      { name: "Food üçï", value: "üçéüçåüçáüçìüçïüçîüçüüå≠üçøüç©", price: 100 },
      { name: "Sport ‚öΩ", value: "‚öΩüèÄüèà‚öæüéæüèêüèâüé±üèìüè∏", price: 100 },
      { name: "Weather ‚òÄÔ∏è", value: "‚òÄÔ∏èüå§Ô∏è‚õÖüå•Ô∏èüå¶Ô∏èüåßÔ∏èüå®Ô∏èüå©Ô∏èüå™Ô∏èüå´Ô∏è", price: 100 },
      { name: "Tech üíª", value: "üíªüñ•Ô∏èüñ®Ô∏è‚å®Ô∏èüñ±Ô∏èüíæüì±üì≤üîãüîå", price: 100 },
      { name: "Nature üå≥", value: "üå≤üå≥üå¥üåµüåæüåøüçÄüçÅüçÇüçÉ", price: 100 },
      { name: "Space üåå", value: "üåïüåñüåóüåòüåëüåíüåìüåîüåô‚≠ê", price: 100 },
      { name: "Music üéµ", value: "üéµüé∂üéºüé§üéßüé∑üé∏üéπü•Åüé∫", price: 100 },
      { name: "Hearts ‚ù§Ô∏è", value: "‚ù§Ô∏èüß°üíõüíöüíôüíúüñ§ü§çü§éüíñ", price: 100 }
    ];

    const cardBacks = [
      { name: "üîµ Blue", value: "üîµ", price: 50 },
      { name: "üî¥ Red", value: "üî¥", price: 50 },
      { name: "üü¢ Green", value: "üü¢", price: 50 },
      { name: "üü° Yellow", value: "üü°", price: 50 },
      { name: "üü£ Purple", value: "üü£", price: 50 },
      { name: "üíé Diamond", value: "üíé", price: 100 },
      { name: "üî• Fireball", value: "üî•", price: 150 },
      { name: "üåà Rainbow", value: "üåà", price: 200 },
      { name: "üíÄ Skull", value: "üíÄ", price: 150 },
      { name: "üßä Ice", value: "üßä", price: 100 }
    ];

    function updateCoins() {
      document.getElementById("coins").innerText = coins;
      localStorage.setItem("coins", coins);
    }

    function updateStats() {
      document.getElementById("gamesPlayed").innerText = gamesPlayed;
      localStorage.setItem("gamesPlayed", gamesPlayed);
    }

    function applyBackground(name) {
      const item = backgrounds.find(b => b.name === name);
      if (!item || !ownedItems[name]) return;
      const bgValue = item.realValue || item.value;
      document.body.style.setProperty('--background', bgValue);
      localStorage.setItem("background", name);
    }

    function openPopup(contentHtml) {
      document.getElementById("popup").style.display = 'flex';
      document.getElementById("popupContent").innerHTML = contentHtml;
    }

    function closePopup() {
      document.getElementById("popup").style.display = 'none';
    }

    function buyItem(type, name, price) {
      if (ownedItems[name]) {
        if (type === "emoji") localStorage.setItem("emojiPack", name);
        if (type === "cardBack") localStorage.setItem("cardBack", name);
        if (type === "background") applyBackground(name);
        closePopup();
        return;
      }
      if (coins >= price) {
        coins -= price;
        ownedItems[name] = true;
        localStorage.setItem("ownedItems", JSON.stringify(ownedItems));
        updateCoins();
        alert(`‚úÖ ${name} f√ºr ${price} Coins gekauft!`);
        if (type === "emoji") localStorage.setItem("emojiPack", name);
        if (type === "cardBack") localStorage.setItem("cardBack", name);
        if (type === "background") applyBackground(name);
        closePopup();
      } else {
        alert("Nicht genug Coins!");
      }
    }

    function openShop() {
      let html = `<h2>üõí Shop</h2><div class='item-grid'>`;

      [...backgrounds, ...cardBacks].forEach(item => {
        const type = backgrounds.includes(item) ? "background" : "cardBack";
        const owned = ownedItems[item.name];
        html += `<div class='shop-item' onclick="buyItem('${type}','${item.name}',${item.price})">
          <div>${item.name}</div>
          <div style="font-size:24px">${item.value}</div>
          <div>${owned ? "‚úÖ Gekauft" : "üí∞ " + item.price}</div>
        </div>`;
      });

      html += `</div><br><button class='button' onclick='closePopup()'>Schlie√üen</button>`;
      openPopup(html);
    }

    function startGame() {
      let html = `<h2>üìê W√§hle Rastergr√∂√üe</h2><div class='item-grid'>`;
      ["4x4", "6x6", "8x8"].forEach(size => {
        html += `<div class='shop-item' onclick="selectEmojiPack('${size}')">${size}</div>`;
      });
      html += `</div><br><button class='button' onclick='closePopup()'>Abbrechen</button>`;
      openPopup(html);
    }

    function selectEmojiPack(gridSize) {
      let html = `<h2>üòä Emoji Pack w√§hlen</h2><div class='item-grid'>`;
      emojis.forEach(pack => {
        const owned = ownedItems[pack.name];
        html += `<div class='shop-item' onclick="finishGameStart('${gridSize}', '${pack.name}', ${pack.price})">
          <div>${pack.name}</div>
          <div style="font-size:24px">${pack.value}</div>
          <div>${owned ? "‚úÖ Gekauft" : "üí∞ " + pack.price}</div>
        </div>`;
      });
      html += `</div><br><button class='button' onclick='closePopup()'>Abbrechen</button>`;
      openPopup(html);
    }

    function finishGameStart(size, packName, price) {
      if (!ownedItems[packName]) {
        if (coins >= price) {
          coins -= price;
          ownedItems[packName] = true;
          updateCoins();
        } else {
          alert("Nicht genug Coins!");
          return;
        }
      }
      localStorage.setItem("gridSize", size);
      localStorage.setItem("emojiPack", packName);
      gamesPlayed++;
      updateStats();
      closePopup();
      window.location.href = "Gamememory.html";
    }

    updateCoins();
    updateStats();
    applyBackground(selectedBackground);
  </script>
</body>
</html>
